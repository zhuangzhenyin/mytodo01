!function(){function t(t){console.log(r),r.push(t),store.set("event",r)}function n(){var t=$(".container .task-list");t.html(null);for(o=0;o<r.length;o++)if(r[o].complated){var n=r.splice(o,1)[0];r.unshift(n)}for(var o=0;o<r.length;o++){var s=e(r[o],o);t.prepend(s),r[o].complated&&($(".container .task-item").addClass("flag"),console.log(o))}i(),a(),p()}function e(t,n){var e="";return e='<div class="task-item" data-index="'+n+'"><input type="checkbox" '+(t.complated?"checked":"")+'><span class="task-title">'+t.content+'</span><span class="delete">删除</span><span class="detail">详情</span></div>',$(e)}function i(){$(".task-list .task-item .delete").each(function(t,e){$(e).on("click",function(){var t=$(this).parent().data("index"),e="";e='<div style="position: fixed; top: 0px; bottom: 0px; left: 0px; right: 0px; background: rgba(0, 0, 0, 0.498039);"></div><div style="color: rgb(68, 68, 68); width: 300px; height: auto; padding: 15px 10px; position: fixed; border-radius: 3px; box-shadow: rgba(0, 0, 0, 0.498039) 0px 1px 2px; left: 522.5px; top: 92px; background: rgb(255, 255, 255);"><div class="pop-title" style="padding: 5px 10px; font-weight: 900; font-size: 20px; text-align: center;">确定删除?</div><div class="pop-content" style="padding: 5px 10px; text-align: center;"><div><button style="margin-right: 5px; background: #46b1e4; display: inline-block;cursor: pointer;color: #333;" class="primary confirm">确定</button><button class="cancel">取消</button></div></div></div>',$(".container").after(e),$(".confirm").on("click",function(){$(".container").siblings().remove(),r.splice(t,1),store.set("event",r),n()}),$(".cancel").on("click",function(){$(".container").siblings().remove()})})})}function a(){$(".task-list .detail").click(function(){var t=$(this).parent().data("index");o(r[t]),c(),l(t),console.log(t)})}function o(t){var n="";n='<div class="task-detail-mask" style="display: block;"></div><div class="task-detail" style="display: block;"><form><div class="content"><span>'+t.content+'</span><span class="esc" style="float: right;">×</span></div><div class="contentTitle"><input style="display: none;" type="text" name="content" value="'+t.content+'"></div><div><div class="desc input-item"><textarea name="desc">'+(t.detailContent||"")+'</textarea></div></div><div class="remind input-item"><label>提醒时间</label><input class="datetime" name="remind_date" type="date" value="'+(t.time||"")+'"></div><div class="input-item"><button type="submit">更新</button></div></form></div>',$(".container .task-list").after(n),s()}function s(){$(".container .task-detail-mask,.esc").click(function(){$(".container .task-detail-mask,.task-detail").remove()})}function l(t){$(".task-detail .input-item").find("button").click(function(e){e.preventDefault();var i={};i.content=$(".task-detail form .content span").eq(0).text(),i.detailContent=$(".input-item").find("textarea").val(),i.time=$(".input-item .datetime").val(),console.log(i),d(t,i),$(".container .task-detail-mask,.task-detail").remove(),n()})}function c(){var t=$(".task-detail form .contentTitle input");console.log($(".task-detail form .contentTitle input")),$(".task-detail form .content").dblclick(function(){t.show(),t.focus(),console.log(t),t.blur(function(){t.val()?($(".task-detail form .content span").eq(0).text(t.val()),t.hide(),console.log(r)):t.hide()})})}function d(t,n){r[t]=$.extend({},r[t],n),store.set("event",r)}function p(){$(".task-list .task-item input").click(function(){var t=$(this).parent().data("index");console.log(r),r[t].complated?d(t,{complated:!1}):d(t,{complated:!0}),n()})}var r=[],u=$(".container .add-task");r=store.get("event")||[],n(),u.on("submit",function(e){e.preventDefault();var i={};i.content=u.find("input").eq(0).val(),i.content&&(t(i),n(),u.find("input").eq(0).val(null))})}();