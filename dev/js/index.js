!function(){function t(t){console.log(m),m.push(t),store.set("event",m)}function e(){var t=$(".container .task-list");t.html(null);for(c=0;c<m.length;c++)if(m[c].complated){var e=m.splice(c,1)[0];m.unshift(e)}for(var c=0;c<m.length;c++){var l=i(m[c],c);t.prepend(l),m[c].complated&&($(".container .task-item").addClass("flag"),console.log(c)),u(l)}n(),a(),o(),p()}function n(){$(".container form input").eq(1).mouseover(function(){$(this).css("background","#46b8e4")}),$(".container form input").eq(1).mouseout(function(){$(this).css("background","#46b1e4")})}function i(t,e){var n="";return n='<div class="task-item" data-index="'+e+'"><input type="checkbox" '+(t.complated?"checked":"")+'><span class="task-title">'+t.content+'</span><span class="delete">删除</span><span class="detail">详情</span></div>',$(n)}function a(){$(".task-list .task-item .delete").each(function(t,n){$(n).on("click",function(){var t=$(this).parent().data("index"),n="";n='<div style="position: fixed; top: 0px; bottom: 0px; left: 0px; right: 0px; background: rgba(0, 0, 0, 0.498039);"></div><div style="color: rgb(68, 68, 68); width: 300px; height: auto; padding: 15px 10px; position: fixed; border-radius: 3px; box-shadow: rgba(0, 0, 0, 0.498039) 0px 1px 2px; left: 522.5px; top: 92px; background: rgb(255, 255, 255);"><div class="pop-title" style="padding: 5px 10px; font-weight: 900; font-size: 20px; text-align: center;">确定删除?</div><div class="pop-content" style="padding: 5px 10px; text-align: center;"><div><button style="margin-right: 5px; background: #46b1e4; display: inline-block;cursor: pointer;color: #333;" class="primary confirm">确定</button><button class="cancel">取消</button></div></div></div>',$(".container").after(n),$(".confirm").on("click",function(){$(".container").siblings().remove(),m.splice(t,1),store.set("event",m),e()}),$(".cancel").on("click",function(){$(".container").siblings().remove()})})})}function o(){$(".task-list .detail").click(function(){var t=$(this).parent().data("index");c(m[t]),d(),s(t),console.log(t)})}function c(t){var e="";e='<div class="task-detail-mask" style="display: block;"></div><div class="task-detail" style="display: block;"><form><div class="content"><span>'+t.content+'</span><span class="esc" style="float: right;">×</span></div><div class="contentTitle"><input style="display: none;" type="text" name="content" value="'+t.content+'"></div><div><div class="desc input-item"><textarea name="desc">'+(t.detailContent||"")+'</textarea></div></div><div class="remind input-item"><label>提醒时间</label><input class="datetime" name="remind_date" type="text" value="'+(t.time||"")+'"></div><div class="input-item"><button type="submit">更新</button></div></form></div>',$(".container .task-list").after(e),$.datetimepicker.setLocale("ch"),$(".datetime").datetimepicker(),l()}function l(){$(".container .task-detail-mask,.esc").click(function(){$(".container .task-detail-mask,.task-detail").remove()})}function s(t){$(".task-detail .input-item").find("button").click(function(n){n.preventDefault();var i={};i.content=$(".task-detail form .content span").eq(0).text(),i.detailContent=$(".input-item").find("textarea").val(),i.time=$(".input-item .datetime").val(),console.log(i),r(t,i),$(".container .task-detail-mask,.task-detail").remove(),e()})}function d(){var t=$(".task-detail form .contentTitle input");console.log($(".task-detail form .contentTitle input")),$(".task-detail form .content").dblclick(function(){t.show(),t.focus(),console.log(t),t.blur(function(){t.val()?($(".task-detail form .content span").eq(0).text(t.val()),t.hide(),console.log(m)):t.hide()})})}function r(t,e){m[t]=$.extend({},m[t],e),store.set("event",m)}function p(){$(".task-list .task-item input").click(function(){var t=$(this).parent().data("index");console.log(m),m[t].complated?r(t,{complated:!1}):r(t,{complated:!0}),e()})}function u(t){console.log(t.timer),clearInterval(g),t.timer=setInterval(function(){var e=t.data("index"),n=(new Date).getTime();if(m[e].complated||!m[e].time)return clearInterval(t.timer),!1;new Date(m[e].time).getTime()-n<=1&&(clearInterval(t.timer),f(e))},1e3)}function f(t){if(!$(".clock-tip")[0]&&!m[t].off){var e="";e='<div class="clock-tip">'+m[t].content+"&nbsp<span>知道了</span></div>",$(".container").before(e),$(".clock-tip span").click(function(){$(".clock-tip").remove(),r(t,{off:!0})}),v()}}function v(){$("#music")[0].play(),console.log($("#music"))}var m=[],k=$(".container .add-task");m=store.get("event")||[],e(),k.on("submit",function(n){n.preventDefault();var i={};i.content=k.find("input").eq(0).val(),i.content&&(t(i),e(),k.find("input").eq(0).val(null))}),console.log(1);var g=null}();